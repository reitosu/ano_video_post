<!--ひとつ前のページへ戻る 好きに使って！-->

<html>
  <head>
    <title>サンプルページ</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    {% csrf_token %}
    <link rel="stylesheet" href='https://unpkg.com/@acab/reset.css'>
    <link rel="stylesheet" href="{% static 'css/check.css' %}">
    <link rel="stylesheet" href="{% static 'css/modal.css' %}">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@vueuse/shared"></script>
    <script src="https://unpkg.com/@vueuse/core"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module" src="{% static 'js/check.js' %}" defer></script>
  </head>

  <body>
    <div id="check">
      <div id="sessions">
        <div id="draft" ref="draftElement" data-draft="{{ request.session.draft }}"></div>
      </div>

      <div id="header">
        <a href="{{request.META.HTTP_REFERER}}">前のページに戻る</a>
        <a href="{% url 'videopost:index' %}">×</a>
      </div>

      <section id="preview">
        <video id="ajvideoPlayer" :src="videoSrc" ref="videoPreview" @loadedmetadata="loadVideo"></video>
      </section>

      <section id="timelines">
        <div id="util">
          <div id="play" v-show="!playFlag" @click.stop="playVideo"></div>
          <div id="stop" v-show="playFlag" @click.stop="pauseVideo">
            <div></div>
            <div></div>
          </div>
          <p>[[ displayCurrentTime.current ]] / [[ displayCurrentTime.duration ]]</p>
        </div>
        <div id="timeline" ref="timelineElement" @mousedown.prevent="moveCurrent" :style="{width:timelineWidth, left:timelineLeft}">
          <div id="currentTime" :style="{left:currentTimePosition+'%'}"></div>
          <div id="times">
              <div v-for="(item,index) in intervalList" :style="{left:item.left}" :id="'time'+index" class="time">
                  [[item.displayTime]]
              </div>
          </div>
        </div>
        <div id="material" ref="material" :style="{width:materialWidth, left:materialLeft}" @mousedown.prevent="move">
          <div id="leftHandle" class="handle" ref="leftHandle" :style="{left:handleLefts.l}" @mousedown.prevent.stop="resize"></div>
          <div id="rightHandle" class="handle" ref="rightHandle" :style="{left:handleLefts.r}" @mousedown.prevent.stop="resize"></div>
        </div>
      </section>
      
      <section id="footer">
        <input id="videoInput" type='file' accept='video/*' @change="selectVideo" style="display: none;">
        <label for="videoInput" class="custom-file-upload"><img src="{% static 'images/edit.png'%}" style="height: 20;"></label>
        <button id="post" @click="trim">次へ</button>
      </section>

      <button @click="togglelastcheck" style="position:absolute; z-index:9998;">button</button>
      <div id="lastCheck">
        <button @click="togglelastcheck">toggle</button>
        <div id="fuzzySearch">
          <input type="search" v-model="inputTag" id="tagInput" ref="tagInputElement">
          <button @click="addTag">追加</button>
          <ul id="searchPrediction" @click="predict">
            <li v-for="history in historys" v-show="inputTag"><div id="historyMark"></div>[[ history ]]</li>
            <li v-for="tag in results">[[ tag.item ]]</li>
          </ul>
        </div>
        <div id="tags" :style="{width:tagsWidth}">
          <div v-for="name in tags" class="tag">
            [[ name ]]
            <p @click="tagDelete">×</p>
          </div>
        </div>
        <video id="lastCheckVideo" ref="lastCheckVideo" controls></video>
        <div>
          <label for="isDeleteOneDay" style="display:inline-flex; padding: 10;">1日で消す<input id="isDeleteOneDay" class="switch" type="checkbox" v-model="isDeleteOneDay"></input></label>
          <button @click="post">投稿</button>
        </div>
      </div>
      </div>
    </div>
  </body>
</html>